<%- include('../partials/head', { title: title }) %>

<h1>Planner â€” <%= match.name %></h1>
<a class="btn btn-link" href="/admin/series/<%= match.series_id %>/matches">â† Back to Travels</a>

<div class="card" style="margin-top:1rem;">
  <div class="travel-meta">
    <strong>Destinations:</strong> <%= match.team_a %> OR <%= match.team_b %><br>
    <strong>Start (IST):</strong>
    <%= moment.utc(match.start_time_utc).tz('Asia/Kolkata').format('YYYY-MM-DD HH:mm') %><br>
    <strong>Points:</strong> <%= match.entry_points %><br>
    <strong>Status:</strong> <%= match.status %>
  </div>
</div>

<hr>

<%
  const countA = predictions.filter(p => p.predicted_team === 'A').length;
  const countB = predictions.filter(p => p.predicted_team === 'B').length;
%>

<div class="summary-box" style="display:flex;gap:1rem;margin:1rem 0;">
  <div class="chip chip-ok">ğŸ• <%= match.team_a %>: <%= countA %> planners</div>
  <div class="chip chip-warn">ğŸ– <%= match.team_b %>: <%= countB %> planners</div>
</div>

<div class="card">
  <h3>ğŸ§­ Travel Planners</h3>
  <% if (predictions.length === 0) { %>
    <p>No planners yet.</p>
  <% } else { %>
    <table class="table">
      <thead>
        <tr><th>Planner</th><th>Chosen Destination</th></tr>
      </thead>
      <tbody>
        <% predictions.forEach(p => { %>
          <tr>
            <td><%= p.display_name %></td>
            <td><%= p.predicted_team === 'A' ? match.team_a : match.team_b %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>
</div>

<%- include('../partials/foot') %>
