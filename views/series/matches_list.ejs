<%- include('../partials/head', { title: labels.matches }) %>

<h1><%= labels.matches %> â€” <%= series.name %></h1>
<a class="btn btn-link js-back" data-fallback="/series">â† Back</a>

<!-- ğŸ“Š My Travel Summary -->
<%
  let totalPoints = 0, plannedCount = 0, missedCount = 0;
  matches.forEach(m => {
    if (m.user_points !== null) totalPoints += m.user_points;
    if (m.user_has_predicted) plannedCount++;
    else if (m.status === 'completed' && !m.user_has_predicted) missedCount++;
  });
%>

<div class="summary-bar">
  <span>ğŸ“Š <strong>My Travel Summary</strong></span>
  <span>Total Points: <strong><%= totalPoints.toFixed(2) %></strong></span>
  <span>Planned: <strong><%= plannedCount %></strong></span>
  <span>Missed: <strong><%= missedCount %></strong></span>
</div>

<!-- ========================= -->
<!-- ğŸŸ¢ Live & Upcoming Travels -->
<!-- ========================= -->
<% if (grouped.upcoming && grouped.upcoming.length > 0) { %>
  <div class="section-block section-upcoming">
    <h2 class="section-title">ğŸŸ¢ Live & Upcoming Travels</h2>
    <div class="travel-grid">
      <% grouped.upcoming.forEach(function(m) { %>
        <%- include('travel_card', { m, series, labels }) %>
      <% }) %>
    </div>
  </div>
<% } %>

<!-- ========================= -->
<!-- ğŸŸ  Ongoing Travels -->
<!-- ========================= -->
<% if (grouped.ongoing && grouped.ongoing.length > 0) { %>
  <div class="section-block section-ongoing">
    <h2 class="section-title">ğŸŸ  Ongoing Travels</h2>
    <div class="travel-grid">
      <% grouped.ongoing.forEach(function(m) { %>
        <%- include('travel_card', { m, series, labels }) %>
      <% }) %>
    </div>
  </div>
<% } %>

<!-- ========================= -->
<!-- âšª Completed Travels -->
<!-- ========================= -->
<% if (grouped.completed && grouped.completed.length > 0) { %>
  <div class="section-block section-completed">
    <h2 class="section-title">âšª Completed Travels</h2>
    <div class="travel-grid">
      <% grouped.completed.forEach(function(m) { %>
        <%- include('travel_card', { m, series, labels }) %>
      <% }) %>
    </div>
  </div>
<% } %>

<!-- ========================= -->
<!-- ğŸ”´ Cancelled / Washed Out -->
<!-- ========================= -->
<% if (grouped.cancelled && grouped.cancelled.length > 0) { %>
  <div class="section-block section-cancelled">
    <h2 class="section-title">ğŸ”´ Cancelled / Washed Out</h2>
    <div class="travel-grid">
      <% grouped.cancelled.forEach(function(m) { %>
        <%- include('travel_card', { m, series, labels }) %>
      <% }) %>
    </div>
  </div>
<% } %>

<!-- If no travels at all -->
<% if (
  (!grouped.upcoming || grouped.upcoming.length === 0) &&
  (!grouped.ongoing || grouped.ongoing.length === 0) &&
  (!grouped.completed || grouped.completed.length === 0) &&
  (!grouped.cancelled || grouped.cancelled.length === 0)
) { %>
  <p class="text-muted">No travels found.</p>
<% } %>


<%- include('../partials/foot') %>

